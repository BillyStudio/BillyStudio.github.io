<!DOCTYPE html>
<html class="has-navbar-fixed-top">
<head><meta name="generator" content="Hexo 3.9.0">
    <!-- hexo-inject:begin --><!-- hexo-inject:end --><meta charset="utf-8">
<title>Translation of Bitcoin notes - 一典</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/outdated-browser/1.1.5/outdatedbrowser.min.css">


<link href="/Nov-23rd-Translation-of-Bitcoin-notes/" rel="alternate" hreflang="en">
    






    <meta name="description" content="&amp;#x6BD4;&amp;#x7279;&amp;#x5E01;&amp;#x7B14;&amp;#x8BB0;">
<meta name="keywords" content="Academic,Blockchain">
<meta property="og:type" content="article">
<meta property="og:title" content="Translation of Bitcoin notes">
<meta property="og:url" content="https://BillyStudio.github.io/zh-cn/Nov-23rd-Translation-of-Bitcoin-notes/index.html">
<meta property="og:site_name" content="Shane&#39;s Blog">
<meta property="og:description" content="&amp;#x6BD4;&amp;#x7279;&amp;#x5E01;&amp;#x7B14;&amp;#x8BB0;">
<meta property="og:locale" content="zh-cn">
<meta property="og:image" content="https://billystudio.github.io/zh-cn/Nov-23rd-Translation-of-Bitcoin-notes/Fig4-2.png">
<meta property="og:image" content="https://billystudio.github.io/zh-cn/Nov-23rd-Translation-of-Bitcoin-notes/Fig4-9.png">
<meta property="og:image" content="https://billystudio.github.io/zh-cn/Nov-23rd-Translation-of-Bitcoin-notes/Fig5-2.png">
<meta property="og:image" content="https://billystudio.github.io/zh-cn/Nov-23rd-Translation-of-Bitcoin-notes/execute_op_checksig.png">
<meta property="og:updated_time" content="2022-03-21T08:05:25.034Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Translation of Bitcoin notes">
<meta name="twitter:description" content="&amp;#x6BD4;&amp;#x7279;&amp;#x5E01;&amp;#x7B14;&amp;#x8BB0;">
<meta name="twitter:image" content="https://billystudio.github.io/zh-cn/Nov-23rd-Translation-of-Bitcoin-notes/Fig4-2.png">





<link rel="icon" href="/favicon.png">


<link rel="stylesheet" href="//fonts.googleapis.com/css?family=Ovo|Source+Code+Pro">
<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/bulma/0.6.2/css/bulma.min.css">


<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/lightgallery/1.6.8/css/lightgallery.min.css">
<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/justifiedGallery/3.6.5/css/justifiedGallery.min.css">


<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/atom-one-light.min.css">

<link rel="stylesheet" href="/css/style.css">

<script defer src="//use.fontawesome.com/releases/v5.0.8/js/all.js"></script><!-- hexo-inject:begin --><!-- hexo-inject:end -->


    
    
    
    
    
    
    
    
    
    

    


</head>
<body>
    
<!-- hexo-inject:begin --><!-- hexo-inject:end --><nav class="navbar is-transparent is-fixed-top navbar-main" role="navigation" aria-label="main navigation">
    <div class="container">
        <div class="navbar-brand">
            <a class="navbar-item navbar-logo" href="/zh-cn">
                
                <img src="/images/logo.png" alt height="28">
                
            </a>
            <div class="navbar-burger">
                <span></span>
                <span></span>
                <span></span>
            </div>
        </div>
        
        <div class="navbar-menu navbar-start">
            
            <a class="navbar-item " href="/zh-cn/categories">分类</a>
            
            <a class="navbar-item " href="/zh-cn/tags">标记</a>
            
            <a class="navbar-item " href="/zh-cn/about">关于</a>
            
        </div>
        
        <div class="navbar-menu navbar-end">
            
            <a class="navbar-item search" title="搜索" href="javascript:;">
                <i class="fas fa-search"></i>
            </a>
            
            
            
            <a class="navbar-item" title="GitHub" href="https://github.com/ppoffice/hexo-theme-minos">
                
                <i class="fab fa-github"></i>
                
            </a>
               
            
	    
<div class="column is-narrow has-text-centered">
    <div class="dropdown is-up is-right is-hoverable" style="margin-top: -0.2em;">
        <div class="dropdown-trigger">
            <button class="button is-small" aria-haspopup="true" aria-controls="dropdown-menu7">
                <span class="icon">
                    <i class="fas fa-globe"></i>
                </span>
                <span>简体中文</span>
                <span class="icon is-small">
            <i class="fas fa-angle-down" aria-hidden="true"></i>
          </span>
            </button>
        </div>
        <div class="dropdown-menu has-text-left" role="menu" style="top:100%">
            <div class="dropdown-content">
            
                <a href="/Nov-23rd-Translation-of-Bitcoin-notes/" class="dropdown-item">
                    English
                </a>
            
                <a href="/zh-cn/Nov-23rd-Translation-of-Bitcoin-notes/" class="dropdown-item">
                    简体中文
                </a>
            
            </div>
        </div>
    </div>
</div>


        </div>
    </div>
</nav>

    <section class="section">
    <div class="container">
    <article class="article content gallery" itemscope itemprop="blogPost">
    <h1 class="article-title is-size-3 is-size-4-mobile" itemprop="name">
        
            Translation of Bitcoin notes
        
    </h1>
    <div class="article-meta columns is-variable is-1 is-multiline is-mobile is-size-7-mobile">
        <span class="column is-narrow">
            
                <time datetime="2019-11-23T15:18:27.000Z" itemprop="datePublished">11月 23 2019</time>
            
        </span>
        
        
        <span class="column is-narrow">
            
            
            36 分钟 读完 (约 5329 字)
        </span>
        
    </div>
    <div class="article-entry is-size-6-mobile" itemprop="articleBody">
    
        <p>&#x6BD4;&#x7279;&#x5E01;&#x7B14;&#x8BB0; <a id="more"></a></p>
<h1 id="Chapter-4-The-Blockchain"><a href="#Chapter-4-The-Blockchain" class="headerlink" title="Chapter 4: The Blockchain"></a>Chapter 4: The Blockchain</h1><p>The blockchain is the database containing a record of all Bitcoin transactions since Bitcoin came into existence in 2009.<br>&#x533A;&#x5757;&#x94FE;&#x81EA;2009&#x5E74;&#x6BD4;&#x7279;&#x5E01;&#x8BDE;&#x751F;&#x4EE5;&#x6765;&#xFF0C;&#x662F;&#x4E00;&#x4E2A;&#x8BB0;&#x5F55;&#x6240;&#x6709;&#x6BD4;&#x7279;&#x5E01;&#x4EA4;&#x6613;&#x7684;&#x6570;&#x636E;&#x5E93;&#x3002;<br>The blockchain consists of a linear list of blocks where each block is composed of a block header followed by a list of Bitcoin transactions.<br>&#x533A;&#x5757;&#x94FE;&#x5305;&#x542B;&#x4E00;&#x4E2A;&#x5B58;&#x50A8;&#x6240;&#x6709;&#x533A;&#x5757;&#x7684;&#x7EBF;&#x6027;&#x5217;&#x8868;&#xFF0C;&#x6BCF;&#x4E2A;&#x533A;&#x5757;&#x5305;&#x62EC;&#x4E00;&#x4E2A;&#x533A;&#x5757;&#x5934;&#xFF0C;&#x540E;&#x9762;&#x8DDF;&#x7740;&#x6BD4;&#x7279;&#x5E01;&#x4EA4;&#x6613;&#x5217;&#x8868;&#x3002;<br>This is illustrated in Figure 4.1.<br>&#x5982;&#x56FE; 4.1 &#x6240;&#x793A;&#x3002;<br><img src="Fig4-2.png" alt="Figure 4.1"><br>A Bitcoin transaction involves the transfer of bitcoins between entities.<br>&#x4E00;&#x4E2A;&#x6BD4;&#x7279;&#x5E01;&#x4EA4;&#x6613;&#x5305;&#x62EC;&#x4E86;&#x5B9E;&#x4F53;&#x4E4B;&#x95F4;&#x6BD4;&#x7279;&#x5E01;&#x7684;&#x8F6C;&#x79FB;&#x3002;<br>We will specify the format of a transaction in the next chapter.<br>&#x6211;&#x4EEC;&#x5C06;&#x5728;&#x4E0B;&#x4E00;&#x7AE0;&#x6307;&#x5B9A;&#x4E00;&#x4E2A;&#x4EA4;&#x6613;&#x7684;&#x5F62;&#x5F0F;&#x3002;<br>For now, a transaction can be thought of as an encoding of the details of a transfer of bitcoins from source Bitcoin addresses to destination Bitcoin addresses.<br>&#x800C;&#x76EE;&#x524D;&#x4E00;&#x4E2A;&#x4EA4;&#x6613;&#x53EF;&#x4EE5;&#x88AB;&#x60F3;&#x6210;&#x662F;&#x4E00;&#x4E2A;&#x4ECE;&#x6BD4;&#x7279;&#x5E01;&#x6E90;&#x5730;&#x5740;&#x5230;&#x6BD4;&#x7279;&#x5E01;&#x76EE;&#x7684;&#x5730;&#x5740;&#x8F6C;&#x79FB;&#x7EC6;&#x8282;&#x7684;&#x7F16;&#x7801;&#x3002;</p>
<p>The first block in the blockchain(the genesis block) was created in January 2009.<br>&#x6BD4;&#x7279;&#x5E01;&#x7684;&#x7B2C;&#x4E00;&#x4E2A;&#x533A;&#x5757;&#xFF08;&#x521B;&#x4E16;&#x5757;&#xFF09;&#x4E8E; 2019 &#x5E74; 1 &#x6708;&#x88AB;&#x521B;&#x5EFA;&#x3002;<br>As for July 2017, the blockchain had more than 478,000 blocks and occupied approximately 125 gigabytes of disk space.<br>&#x800C;&#x5230;&#x4E86;2017&#x5E74;7&#x6708;&#xFF0C;&#x533A;&#x5757;&#x94FE;&#x5DF2;&#x6709;&#x8D85;&#x8FC7; 478000 &#x4E2A;&#x533A;&#x5757;&#x5E76;&#x4E14;&#x5360;&#x636E;&#x4E86;&#x5927;&#x6982; 125G &#x7684;&#x786C;&#x76D8;&#x7A7A;&#x95F4;&#x3002;<br>Until August 2017, the maximum size of a block was 1 megabyte (1,000,000 bytes).<br>In August 2017, a new feature called Segregated Witness(SegWit) was activated in the Bitcoin network which effectively increased the maximum block size to 4 megabytes.<br>&#x5728;2017&#x5E74;8&#x6708;&#xFF0C;&#x4E00;&#x4E2A;&#x53EB;&#x505A;&#x9694;&#x79BB;&#x8BC1;&#x660E;&#xFF08;SegWit&#xFF09;&#x7684;&#x65B0;&#x7279;&#x6027;&#x5728;&#x6BD4;&#x7279;&#x5E01;&#x7F51;&#x7EDC;&#x4E2D;&#x88AB;&#x6FC0;&#x6D3B;&#xFF0C;&#x6709;&#x6548;&#x5730;&#x5C06;&#x6700;&#x5927;&#x5757;&#x89C4;&#x6A21;&#x6269;&#x5927;&#x5230; 4MB&#x3002;<br>The motivation for and design of SegWit will be discussed in the next chapter as it requires us to first understand some shortcomings in the pre-SegWit Bitcoin system.<br>&#x9694;&#x79BB;&#x8BC1;&#x660E;&#x7684;&#x542F;&#x53D1;&#x548C;&#x8BBE;&#x8BA1;&#x5C06;&#x5728;&#x4E0B;&#x4E00;&#x7AE0;&#x8BA8;&#x8BBA;&#x56E0;&#x4E3A;&#x8FD9;&#x4F1A;&#x4F7F;&#x6211;&#x4EEC;&#x9996;&#x6B21;&#x8BA4;&#x8BC6;&#x5230;&#x524D;-&#x9694;&#x79BB;&#x8BC1;&#x660E;&#x7684;&#x533A;&#x5757;&#x94FE;&#x7CFB;&#x7EDF;&#x7684;&#x4E00;&#x4E9B;&#x7F3A;&#x9677;&#x3002;</p>
<p>In this chapter, we will describe the blockchain and explain the motivation behind different aspects of its design.<br>&#x5728;&#x8FD9;&#x4E00;&#x7AE0;&#x4E2D;&#xFF0C;&#x6211;&#x4EEC;&#x5C06;&#x63CF;&#x8FF0;&#x533A;&#x5757;&#x94FE;&#x5E76;&#x89E3;&#x91CA;&#x5404;&#x90E8;&#x5206;&#x8BBE;&#x8BA1;&#x7684;&#x52A8;&#x673A;&#x3002;</p>
<h2 id="4-1-Rewarding-Blockchain-Updation"><a href="#4-1-Rewarding-Blockchain-Updation" class="headerlink" title="4.1  Rewarding Blockchain Updation"></a>4.1  Rewarding Blockchain Updation</h2><p>The task of storing and updating the blockchain is performed collectively by the nodes in the Bitcoin P2P network.<br>&#x50A8;&#x5B58;&#x548C;&#x66F4;&#x65B0;&#x533A;&#x5757;&#x94FE;&#x7684;&#x4EFB;&#x52A1;&#x5728;&#x6BD4;&#x7279;&#x5E01;P2P&#x7F51;&#x7EDC;&#x4E2D;&#x88AB;&#x7ED3;&#x70B9;&#x5171;&#x540C;&#x6267;&#x884C;&#x3002;<br>Nodes called full nodes store a copy of the blockchain on their hard disks.<br>&#x88AB;&#x6210;&#x4E3A;&#x5168;&#x7ED3;&#x70B9;&#x7684;&#x7ED3;&#x70B9;&#x5728;&#x4ED6;&#x4EEC;&#x7684;&#x786C;&#x76D8;&#x4E0A;&#x5B58;&#x50A8;&#x4E00;&#x4EFD;&#x533A;&#x5757;&#x94FE;&#x7684;&#x526F;&#x672C;&#x3002;<br>When a full node connects to the Bitcoin network for the first time, it downloads a copy of the blockchain from the existing full nodes.<br>&#x5F53;&#x4E00;&#x4E2A;&#x5168;&#x7ED3;&#x70B9;&#x9996;&#x6B21;&#x8FDE;&#x5165;&#x533A;&#x5757;&#x94FE;&#x7F51;&#x7EDC;&#x65F6;&#xFF0C;&#x4F1A;&#x4ECE;&#x5DF2;&#x7ECF;&#x5B58;&#x5728;&#x7684;&#x5168;&#x7ED3;&#x70B9;&#x4E0B;&#x8F7D;&#x4E00;&#x4EFD;&#x533A;&#x5757;&#x94FE;&#x7684;&#x526F;&#x672C;&#x3002;<br>The task of adding blocks to the blockchain is called mining and is done by full nodes called miners.<br>&#x5C06;&#x533A;&#x5757;&#x52A0;&#x5165;&#x5230;&#x533A;&#x5757;&#x94FE;&#x7684;&#x4EFB;&#x52A1;&#x7531;&#x5168;&#x7ED3;&#x70B9;&#x5B8C;&#x6210;&#xFF0C;&#x8FD9;&#x4E2A;&#x8FC7;&#x7A0B;&#x79F0;&#x4E3A;&#x6316;&#x77FF;&#xFF0C;&#x8FD9;&#x4E9B;&#x5168;&#x7ED3;&#x70B9;&#x79F0;&#x4E3A;&#x77FF;&#x5DE5;&#x3002;<br>The naming convention for mining/miners was chosen because the mining task involves the solution to a difficult computational problem and a miner which successfully solves such a problem is rewarded with newly created bitcoins.<br>&#x9009;&#x62E9;&#x4F7F;&#x7528;&#x6316;&#x77FF;&#x3001;&#x77FF;&#x5DE5;&#x8FD9;&#x6837;&#x7684;&#x547D;&#x540D;&#x7EA6;&#x5B9A;&#x662F;&#x56E0;&#x4E3A;&#x8FD9;&#x4E2A;&#x8FC7;&#x7A0B;&#x6D89;&#x53CA;&#x89E3;&#x51B3;&#x56F0;&#x96BE;&#x7684;&#x8BA1;&#x7B97;&#x95EE;&#x9898;&#x4EE5;&#x53CA;&#x6210;&#x529F;&#x6C42;&#x89E3;&#x51FA;&#x8FD9;&#x6837;&#x4E00;&#x4E2A;&#x95EE;&#x9898;&#x7684;&#x5168;&#x7ED3;&#x70B9;&#x4F1A;&#x88AB;&#x5956;&#x52B1;&#x65B0;&#x4EA7;&#x751F;&#x7684;&#x6BD4;&#x7279;&#x5E01;&#x3002;<br>This reward is called the <em>block subsidy</em> and is currently equal to 12.5 bitcoins per block.<br>&#x8FD9;&#x4E2A;&#x5956;&#x52B1;&#x88AB;&#x79F0;&#x4E3A;&#x533A;&#x5757;&#x8865;&#x8D34;&#xFF0C;&#x76EE;&#x524D;&#x4E3A;&#x6BCF;&#x4E2A;&#x533A;&#x5757;12.5&#x4E2A;&#x6BD4;&#x7279;&#x5E01;&#x3002;</p>
<p>We will discuss the details of the computational problem used in Bitcoin mining in Section 4.3 after we describe the block header structure.</p>
<h3 id="4-3-Mining"><a href="#4-3-Mining" class="headerlink" title="4.3 Mining"></a>4.3 Mining</h3><p>A miner node forms a candidate block by collecting some transactions from its mempool.<br>&#x4E00;&#x4E2A;&#x65F7;&#x5DE5;&#x7ED3;&#x70B9;&#xFF08;&#x53EF;&#x4EE5;&#x662F;&#x4E00;&#x53F0;&#x4E3B;&#x673A;&#x3001;&#x6216;&#x4E00;&#x4E2A;&#x8FDB;&#x7A0B;&#xFF09;&#x4ECE;&#x5185;&#x5B58;&#x6C60;&#x4E2D;&#x6536;&#x96C6;&#x4E00;&#x4E9B;&#x4EA4;&#x6613;&#x7528;&#x4E8E;&#x751F;&#x6210;&#x4E00;&#x4E2A;&#x5019;&#x9009;&#x533A;&#x5757;&#xFF08;&#x8FD8;&#x4E0D;&#x662F;&#x533A;&#x5757;&#x94FE;&#x4E0A;&#x7684;&#x65B0;&#x533A;&#x5757;&#xFF09;&#x3002;</p>
<p>The height of a block in the blockchain is the number of blocks preceding it.<br>The genesis block has height 0, the immediate successor of the genesis block has height 1 and so on.<br>&#x521B;&#x4E16;&#x5757;&#x7684;&#x9AD8;&#x5EA6;&#x4E3A;0&#xFF0C;&#x7D27;&#x63A5;&#x7740;&#x7684;&#x533A;&#x5757;&#x9AD8;&#x5EA6;&#x4E3A;1&#xFF0C;&#x4EE5;&#x6B64;&#x7C7B;&#x63A8;&#x3002;<br>Suppose a miner node is attempting to add a candidate block at height $N$.<br>&#x5047;&#x8BBE;&#x4E00;&#x4E2A;&#x65F7;&#x5DE5;&#x7ED3;&#x70B9;&#x5C1D;&#x8BD5;&#x5728;&#x9AD8;&#x5EA6;N&#x4E0A;&#x6DFB;&#x52A0;&#x4E00;&#x4E2A;&#x5019;&#x9009;&#x7ED3;&#x70B9;&#x3002;<br>The newest block in the node&#x2019;s copy of the blockchain has height $N-1$.<br>&#x533A;&#x5757;&#x94FE;&#x526F;&#x672C;&#x4E0A;&#x7684;&#x7684;&#x6700;&#x65B0;&#x533A;&#x5757;&#x9AD8;&#x5EA6;&#x4E3A; N-1.<br>The <code>hashPrevBlock</code> field of the candidate block header is populated with the block hash of the block at height N-1.<br>&#x5019;&#x9009;&#x5757;&#x7684; <code>hashPrevBlock</code> &#x5B57;&#x6BB5;&#x7531;&#x9AD8;&#x5EA6;N-1&#x7684;&#x533A;&#x5757;&#x8BA1;&#x7B97;&#x800C;&#x6765;&#x3002;<br>The <code>hashMerkleRoot</code> field is populated with the Merkle root of the transactions in the candidate block.<br><code>hashMerkleRoot</code> &#x5B57;&#x6BB5;&#x7531;&#x5019;&#x9009;&#x5757;&#x4E2D;&#x4EA4;&#x6613;&#x751F;&#x6210;&#x7684; Merkle &#x6570;&#x8BA1;&#x7B97;&#x800C;&#x6765;&#x3002;<br>The <code>nVersion</code> field contains the current block version number.</p>
<p>The <code>nTime</code> field is populated with a timestamp in Unix time format to record the time of candidate block creation.<br><code>nTime</code> &#x5B57;&#x6BB5;&#x5728; Unix &#x65F6;&#x95F4;&#x683C;&#x5F0F;&#x4E0B;&#x8BB0;&#x5F55;&#x5019;&#x9009;&#x5757;&#x7684;&#x751F;&#x6210;&#x65F6;&#x95F4;&#x6233;&#x3002;<br>The Unix time is the number of seconds which have elapsed since 12:00 AM Coordinated Universal Time on January 1st, 1970 with deductions to account for leap seconds.<br>Unix&#x65F6;&#x95F4;&#x6307;&#x7684;&#x662F;&#x4ECE;&#x6807;&#x51C6;&#x56FD;&#x9645;&#x65F6;&#x95F4;1970&#x5E74;1&#x6708;1&#x65E5; 12:00 AM &#x5230;&#x5F53;&#x524D;&#x65F6;&#x95F4;&#x6240;&#x7ECF;&#x5386;&#x7684;&#x79D2;&#x6570;&#x3002;<br>Each node in the network has a local clock which is not necessarily synchronized with the local clocks of the other nodes.<br>&#x7F51;&#x7EDC;&#x4E2D;&#x7684;&#x6BCF;&#x4E2A;&#x7ED3;&#x70B9;&#x90FD;&#x6709;&#x4E00;&#x4E2A;&#x672C;&#x5730;&#x65F6;&#x949F;&#xFF0C;&#x4E0D;&#x5FC5;&#x8981;&#x548C;&#x5176;&#x4ED6;&#x7ED3;&#x70B9;&#x7684;&#x672C;&#x5730;&#x65F6;&#x949F;&#x8FDB;&#x884C;&#x65F6;&#x95F4;&#x540C;&#x6B65;&#x3002;<br>So there is no globally unique notion of time in the network.<br>&#x6240;&#x4EE5;&#x5728;&#x7F51;&#x7EDC;&#x4E2D;&#x6CA1;&#x6709;&#x7EDF;&#x4E00;&#x7684;&#x65F6;&#x95F4;&#x3002;<br>The Bitcoin system does not specify an explicit algorithm for calculating the <code>nTime</code> field in a candidate block.<br>&#x6BD4;&#x7279;&#x5E01;&#x7CFB;&#x7EDF;&#x6CA1;&#x6709;&#x6307;&#x660E;&#x5728;&#x4E00;&#x4E2A;&#x5019;&#x9009;&#x533A;&#x5757;&#x4E2D;&#x8BA1;&#x7B97; <code>nTime</code> &#x5B57;&#x6BB5;&#x7684;&#x76F4;&#x63A5;&#x7B97;&#x6CD5;&#xFF0C;<br>However, it imposes two constraints to ensure that the timestamp in the <code>nTime</code> field is approximately correct:<br>&#x4F46;&#x662F;&#x5374;&#x4E24;&#x79CD;&#x5F15;&#x5165;&#x4E86;&#x4E24;&#x79CD;&#x7EA6;&#x675F;&#x6765;&#x4FDD;&#x8BC1;<code>nTime</code>&#x4E2D;&#x7684;&#x65F6;&#x95F4;&#x6233;&#x7684;&#x5927;&#x81F4;&#x6B63;&#x786E;&#x6027;&#xFF1A;</p>
<ul>
<li>In a candidate block at height N, the <code>nTime</code> field is required to be strictly greater than the median of the <code>nTime</code> values in the 11 blocks in the blockchain at heights N-1, N-2, &#x2026;, N-11.<br>&#x5728;&#x4E00;&#x4E2A;&#x9AD8;&#x5EA6;&#x4E3A; N &#x7684;&#x5019;&#x9009;&#x533A;&#x5757;&#x4E2D;&#xFF0C;&#x8981;&#x6C42;<code>nTime</code>&#x5B57;&#x6BB5;&#x5E94;&#x4E25;&#x683C;&#x5927;&#x4E8E;&#x9AD8;&#x5EA6;&#x4E3A;N-1, N-2, &#x2026;, N-11&#x533A;&#x5757;&#x7684;&#x6240;&#x6709;<code>nTime</code>&#x503C;&#x7684;&#x4E2D;&#x4F4D;&#x6570;&#x3002;<br>Note that this constraint causes the median-time-past values to increase monotonically with block height, even if the <code>nTime</code> fields do not. &#x6CE8;&#x610F;&#x5230;&#x6B64;&#x9879;&#x7EA6;&#x675F;&#x4F7F;&#x5F97;&#x968F;&#x7740;&#x533A;&#x5757;&#x9AD8;&#x5EA6;&#x7684;&#x589E;&#x957F;&#xFF0C;&#x4E2D;&#x4F4D;&#x6570;&#x65F6;&#x95F4;&#x5355;&#x8C03;&#x9012;&#x589E;&#x3002;</li>
<li>When a network node receives a candidate block created by a miner, it rejects it if the <code>nTime</code> field specifies a time which exceeds the node&#x2019;s <em>network-adjusted time</em> by more than two hours.<br>&#x5F53;&#x4E00;&#x4E2A;&#x7F51;&#x7EDC;&#x7ED3;&#x70B9;&#x63A5;&#x6536;&#x4E00;&#x4E2A;&#x65F7;&#x5DE5;&#x7ED3;&#x70B9;&#x5EFA;&#x7ACB;&#x7684;&#x5019;&#x9009;&#x533A;&#x5757;&#x65F6;&#xFF0C;&#x5982;&#x679C;<code>nTime</code>&#x5B57;&#x6BB5;&#x6307;&#x5B9A;&#x4E86;&#x4E00;&#x4E2A;&#x8D85;&#x8FC7;&#x7ED3;&#x70B9;&#x7684;&#x7F51;&#x7EDC;&#x534F;&#x8C03;&#x65F6;&#x95F4;2&#x5C0F;&#x65F6;&#xFF0C;&#x5219;&#x4F1A;&#x62D2;&#x7EDD;&#x6B64;&#x5019;&#x9009;&#x533A;&#x5757;&#x3002;<br>The network-adjusted time at a node is the median of the local clocks of the other nodes it is connected to.<br>&#x4E00;&#x4E2A;&#x7ED3;&#x70B9;&#x7684;&#x7F51;&#x7EDC;&#x534F;&#x8C03;&#x65F6;&#x95F4;&#x662F;&#x6307;&#x4E0E;&#x8BE5;&#x7ED3;&#x70B9;&#x76F8;&#x8FDE;&#x7684;&#x5176;&#x4ED6;&#x7ED3;&#x70B9;&#x7684;&#x672C;&#x5730;&#x65F6;&#x95F4;&#x6570;&#x503C;&#x7684;&#x4E2D;&#x4F4D;&#x6570;&#x3002;</li>
</ul>
<p>A miner node is free set to the <code>nTime</code> field to any value which satisfies these constraints.<br>&#x5728;&#x6EE1;&#x8DB3;&#x7EA6;&#x675F;&#x6761;&#x4EF6;&#x4E0B;&#xFF0C;&#x4E00;&#x4E2A;&#x65F7;&#x5DE5;&#x7ED3;&#x70B9;&#x53EF;&#x4EE5;&#x81EA;&#x7531;&#x8BBE;&#x7F6E;<code>nTime</code>&#x5B57;&#x6BB5;&#x503C;&#x3002;<br>The first constraint specifies a lower bound on <code>nTime</code> which can be calculated from the current blocks in the blockchain.</p>
<p>Assuming that the output of the SHA-256 function behaves like a random 256-bit string where each bit is equally like to be 0 or 1 independently of the other bits, the probability that the block hash falls below the target threshold T for a trial nNonce value is<br>&#x5047;&#x8BBE;&#x5C06;SHA-256&#x51FD;&#x6570;&#x7684;&#x8F93;&#x51FA;&#x770B;&#x505A;&#x4E00;&#x4E2A;256&#x4F4D;&#x7684;&#x968F;&#x673A;&#x4E32;&#xFF0C;&#x5176;&#x4E2D;&#x6BCF;&#x4E2A;&#x6BD4;&#x7279;&#x4E4B;&#x95F4;&#x53D6;0&#x8FD8;&#x662F;&#x53D6;1&#x662F;&#x76F8;&#x4E92;&#x72EC;&#x7ACB;&#x7684;&#xFF0C;&#x533A;&#x5757;&#x6742;&#x51D1;&#x503C;&#x7B49;&#x4E8E;&#x6216;&#x4F4E;&#x4E8E;&#x9608;&#x503C;T&#x7684;&#x6982;&#x7387;&#x662F;<br>$$<br>p = \frac{T+1}{2^256}<br>$$</p>
<p>Modelling each try by the miner as a Bernoulli random process with success probability p, the average number of trials required to find a block hash below the threshold 1/p.</p>
<h2 id="4-4-Bitcoin-Transactions"><a href="#4-4-Bitcoin-Transactions" class="headerlink" title="4.4 Bitcoin Transactions"></a>4.4 Bitcoin Transactions</h2><p>While a single output in the coinbase transaction is sufficient for a miner to gain control of the block reward, multiple outputs give the miner flexibility to distribute the block reward to multiple addresses.<br>&#x5C3D;&#x7BA1;coinbase&#x4EA4;&#x6613;&#x4E2D;&#x5355;&#x4E00;&#x8F93;&#x51FA;&#x5C31;&#x8DB3;&#x591F;&#x6EE1;&#x8DB3;&#x4E00;&#x4E2A;&#x65F7;&#x5DE5;&#x5BF9;&#x533A;&#x5757;&#x56DE;&#x62A5;&#x7684;&#x63A7;&#x5236;&#xFF0C;&#x591A;&#x4E2A;&#x8F93;&#x51FA;&#x7ED9;&#x4E86;&#x65F7;&#x5DE5;&#x5C06;&#x533A;&#x5757;&#x56DE;&#x62A5;&#x5206;&#x914D;&#x5230;&#x591A;&#x4E2A;&#x5730;&#x5740;&#x7684;&#x7075;&#x6D3B;&#x6027;&#x3002;</p>
<p>The amounts in the regular transaction outputs can take any value as long as the sum of the amounts does not exceed the total amount of bitcoins unlocked by the inputs.<br>&#x5E38;&#x89C4;&#x4EA4;&#x6613;&#x8F93;&#x51FA;&#x6BB5;&#x4E2D;&#x7684;&#x6570;&#x989D;&#x53EF;&#x4EE5;&#x53D6;&#x4EFB;&#x610F;&#x503C;&#xFF0C;&#x53EA;&#x8981;&#x6EE1;&#x8DB3;&#x6570;&#x989D;&#x4E4B;&#x548C;&#x4E0D;&#x8D85;&#x8FC7;&#x88AB;&#x8F93;&#x5165;&#x7AEF;&#x88AB;&#x89E3;&#x9501;&#x6570;&#x989D;&#x4E4B;&#x548C;&#x3002;</p>
<p>How is the value of the transaction</p>
<h2 id="4-5-Bitcoin-Ownership"><a href="#4-5-Bitcoin-Ownership" class="headerlink" title="4.5 Bitcoin Ownership"></a>4.5 Bitcoin Ownership</h2><p>When an output of a previous transaction is unlocked by the input of a later transaction, all the bitcoins in the output need to be spent.<br>&#x5F53;&#x4E00;&#x4E2A;&#x4EA4;&#x6613;&#x8F93;&#x51FA;&#x88AB;&#x540E;&#x4E00;&#x4E2A;&#x4EA4;&#x6613;&#x7684;&#x8F93;&#x5165;&#x89E3;&#x9501;&#xFF0C;&#x91CC;&#x9762;&#x7684;&#x6240;&#x6709;&#x6BD4;&#x7279;&#x5E01;&#x9700;&#x8981;&#x88AB;&#x82B1;&#x8D39;&#x3002;<br>This implies that a transaction output can be in only one of two states: spent or unspent.<br>&#x8FD9;&#x610F;&#x5473;&#x8FD9;&#x4E00;&#x7B14;&#x4EA4;&#x6613;&#x8F93;&#x51FA;&#x53EA;&#x53EF;&#x80FD;&#x662F;&#x4E24;&#x79CD;&#x72B6;&#x6001;&#xFF1A;&#x82B1;&#x8D39;&#x6216;&#x672A;&#x82B1;&#x8D39;&#x3002;</p>
<h1 id="Chapter-5-Bitcoin-Transactions"><a href="#Chapter-5-Bitcoin-Transactions" class="headerlink" title="Chapter 5 Bitcoin Transactions"></a>Chapter 5 Bitcoin Transactions</h1><p>In this section, we give a high-level description of Bitcoin transactions in order to discuss the security properties of the blockchain.<br>&#x5728;&#x8FD9;&#x4E00;&#x90E8;&#x5206;&#x4E2D;&#xFF0C;&#x6211;&#x4EEC;&#x4E3A;&#x4E86;&#x8BA8;&#x8BBA;&#x6BD4;&#x7279;&#x5E01;&#x7684;&#x5B89;&#x5168;&#x6027;&#x8D28;&#xFF0C;&#x7ED9;&#x51FA;&#x6BD4;&#x7279;&#x5E01;&#x4EA4;&#x6613;&#x7684;&#x9876;&#x5C42;&#x63CF;&#x8FF0;&#x3002;<br>A more detailed description of the transaction format will be given in Chapter 5.</p>
<p>A Bitcoin transaction encodes a transfer of bitcoins between entities.<br>&#x4E00;&#x4E2A;&#x6BD4;&#x7279;&#x5E01;&#x4EA4;&#x6613;&#x5BF9;&#x5B9E;&#x4F53;&#x4E4B;&#x95F4;&#x6BD4;&#x7279;&#x5E01;&#x7684;&#x4EA4;&#x6613;&#x8FDB;&#x884C;&#x7F16;&#x7801;&#x3002;<br>A destination of the transfer in a transaction is called an output.<br>&#x6BCF;&#x7B14;&#x4EA4;&#x6613;&#x7684;&#x53BB;&#x5411;&#x88AB;&#x79F0;&#x4E3A;&#x8F93;&#x51FA;&#x3002;<br>A single transaction can have several outputs.<br>&#x5355;&#x7B14;&#x4EA4;&#x6613;&#x53EF;&#x4EE5;&#x6709;&#x591A;&#x4E2A;&#x8F93;&#x51FA;&#x3002;<br>Each output in a transaction can server as a source of bitcoins in a later transaction.<br>&#x4EA4;&#x6613;&#x7684;&#x6BCF;&#x4E2A;&#x8F93;&#x51FA;&#x53EF;&#x4EE5;&#x4F5C;&#x4E3A;&#x540E;&#x7EED;&#x4EA4;&#x6613;&#x7684;&#x6BD4;&#x7279;&#x5E01;&#x7684;&#x6E90;&#x5934;&#x3002;<br>When previous transaction outputs are specified as sources of bitcoins in a transaction, they are called input.<br>&#x8FD9;&#x4E9B;&#x7528;&#x4E8E;&#x4F5C;&#x4E3A;&#x6BD4;&#x7279;&#x5E01;&#x4EA4;&#x6613;&#x7684;&#x6E90;&#x5934;&#x7684;&#x524D;&#x9762;&#x7684;&#x8F93;&#x51FA;&#x6BB5;&#x88AB;&#x79F0;&#x4E3A;&#x8F93;&#x5165;&#x3002;<br>A coinbase transaction has no input and at least one output.<br>&#x4E00;&#x4E2A; coinbase &#x4EA4;&#x6613;&#x6CA1;&#x6709;&#x8F93;&#x5165;&#x4F46;&#x81F3;&#x5C11;&#x6709;&#x4E00;&#x4E2A;&#x8F93;&#x51FA;&#x3002;<br>There is no input because the source of bitcoins is not a previous transaction output but the block reward, i.e., the sum of the block subsidy and the transaction fees from the transactions in the block.<br>&#x6CA1;&#x6709;&#x8F93;&#x5165;&#x7684;&#x539F;&#x56E0;&#x662F;&#x8FD9;&#x4E9B;&#x6BD4;&#x7279;&#x5E01;&#x7684;&#x6E90;&#x5934;&#x4E0D;&#x662F;&#x4E00;&#x4E2A;&#x5148;&#x524D;&#x4EA4;&#x6613;&#x7684;&#x8F93;&#x51FA;&#x800C;&#x662F;&#x4E00;&#x4E2A;&#x5956;&#x52B1;&#x5757;&#xFF0C;&#x5373;&#x533A;&#x5757;&#x7684;&#x63F4;&#x52A9;&#x6B3E;&#x4E4B;&#x548C;&#x52A0;&#x4E0A;&#x5757;&#x4E2D;&#x7684;&#x4EA4;&#x6613;&#x82B1;&#x8D39;&#x3002;<br>Each output in the coinbase transaction specifies two items:<br>&#x6BCF;&#x4E2A; coinbase &#x4EA4;&#x6613;&#x7684;&#x8F93;&#x51FA;&#x9700;&#x8981;&#x6307;&#x5B9A;&#x4E24;&#x9879;&#xFF1A;</p>
<ul>
<li>The amount of bitcoins from the block reward which are associated with this output. &#x5757;&#x4E2D;&#x4E0E;&#x6B64;&#x6B21;&#x8F93;&#x51FA;&#x76F8;&#x5173;&#x7684;&#x5956;&#x52B1;&#x6BD4;&#x7279;&#x5E01;&#x7684;&#x6570;&#x91CF;</li>
<li>A script which specifies the conditions under which the bitcoins associated with this output can be spent. &#x6307;&#x5B9A;&#x4E86;&#x4E0E;&#x5F53;&#x524D;&#x8F93;&#x51FA;&#x76F8;&#x5173;&#x8054;&#x7684;&#x3001;&#x6BD4;&#x7279;&#x5E01;&#x53EF;&#x88AB;&#x82B1;&#x8D39;&#x7684;&#x6761;&#x4EF6;&#x7684;&#x811A;&#x672C;</li>
</ul>
<p>The script in an output can be thought of as a challenge.<br>&#x5728;&#x8F93;&#x51FA;&#x6BB5;&#x4E2D;&#x7684;&#x811A;&#x672C;&#x53EF;&#x4EE5;&#x88AB;&#x770B;&#x505A;&#x662F;&#x4E00;&#x4E2A;&#x6311;&#x6218;&#x3002;<br>An entity which provides a satisfactory response can transfer the bitcoins associated with the output.<br>&#x80FD;&#x63D0;&#x4F9B;&#x6B63;&#x786E;&#x56DE;&#x5E94;&#x7684;&#x5B9E;&#x4F53;&#x53EF;&#x4EE5;&#x8F6C;&#x79FB;&#x4E0E;&#x8F93;&#x51FA;&#x6BB5;&#x76F8;&#x5173;&#x8054;&#x7684;&#x6BD4;&#x7279;&#x5E01;&#x3002;<br>Figure 4.9 illustrates a bitcoin transaction with two outputs.<br>&#x56FE; 4.9 &#x5C55;&#x73B0;&#x7684;&#x662F;&#x4E00;&#x4E2A;&#x62E5;&#x6709;&#x4E24;&#x4E2A;&#x8F93;&#x51FA;&#x7684;&#x6BD4;&#x7279;&#x5E01;&#x4EA4;&#x6613;&#x3002;<br><img src="Fig4-9.png" alt="Figure 4.9"></p>
<p>The first output specifies an amount of $x_1$ and a challenge script $C_1$.<br>&#x7B2C;&#x4E00;&#x4E2A;&#x8F93;&#x51FA;&#x6307;&#x660E;&#x4E86;&#x6570;&#x989D; $x_1$ &#x548C;&#x6311;&#x6218;&#x811A;&#x672C; $C_1$&#x3002;<br>A satisfactory response to $C_1$ is needed to spend the $x_1$ bitcoins.<br>&#x82B1;&#x8D39;&#x6389; $x_1$ &#x6BD4;&#x7279;&#x5E01;&#x9700;&#x8981;&#x4E00;&#x4E2A;&#x5BF9; $C_1$ &#x7684;&#x6B63;&#x786E;&#x56DE;&#x5E94;&#x3002;<br>Similarly, a satisfactory response to the challenge script $C_2$ is needed to spend the $x_2$ bitcoins in the second output. </p>
<h2 id="Pre-SegWit-Regular-Transactions"><a href="#Pre-SegWit-Regular-Transactions" class="headerlink" title="Pre-SegWit Regular Transactions"></a>Pre-SegWit Regular Transactions</h2><p>The format of a pre-SegWit regular transaction is shown in Figure 5.2.<br><img src="Fig5-2.png" alt="Figure 5.2"></p>
<p>The field names in teletype font (like <code>nVersion</code>) are from the Bitcoin Core reference client.<br>&#x4EE5;&#x7535;&#x6587;&#x5B57;&#x4F53;&#x8868;&#x793A;&#x7684;&#x5B57;&#x6BB5;&#x540D;&#xFF08;&#x6BD4;&#x5982; nVersion&#xFF09;&#x4ECE;&#x6BD4;&#x7279;&#x5E01;&#x6838;&#x5FC3;&#x53C2;&#x8003;&#x5BA2;&#x6237;&#x7AEF;&#x4E2D;&#x83B7;&#x53D6;&#x3002;</p>
<h2 id="5-5-Pre-SegWit-Standard-Scripts"><a href="#5-5-Pre-SegWit-Standard-Scripts" class="headerlink" title="5.5 Pre-SegWit Standard Scripts"></a>5.5 Pre-SegWit Standard Scripts</h2><p>When a new regular transaction is broadcast on the network for inclusion in the blockchain, each node which hears the transaction validates it by evaluating the challenge and response scripts.<br>&#x5F53;&#x4E00;&#x4E2A;&#x65B0;&#x7684;&#x5E38;&#x89C4;&#x4EA4;&#x6613;&#x5728;&#x7F51;&#x7EDC;&#x4E0A;&#x5E7F;&#x64AD;&#x4EE5;&#x56CA;&#x62EC;&#x5230;&#x533A;&#x5757;&#x94FE;&#x4E2D;&#xFF0C;&#x6536;&#x5230;&#x4EA4;&#x6613;&#x7684;&#x6BCF;&#x4E2A;&#x7ED3;&#x70B9;&#x901A;&#x8FC7;&#x6267;&#x884C;&#x9501;&#x5B9A;&#x548C;&#x89E3;&#x9501;&#x811A;&#x672C;&#x8FDB;&#x884C;&#x9A8C;&#x8BC1;&#x3002;<br>Valid transactions are then relayed by the node to its neighboring nodes, which in turn will perform their own validation.<br>&#x63A5;&#x7740;&#x8FD9;&#x4E9B;&#x6709;&#x6548;&#x4EA4;&#x6613;&#x6269;&#x6563;&#x5230;&#x76F8;&#x90BB;&#x7ED3;&#x70B9;&#xFF0C;&#x76F8;&#x90BB;&#x7ED3;&#x70B9;&#x8FDB;&#x800C;&#x4E5F;&#x5C06;&#x6267;&#x884C;&#x9501;&#x5B9A;&#x548C;&#x89E3;&#x9501;&#x811A;&#x672C;&#x3002;<br>If no restrictions are placed on the challenge and response scripts, a malicous node can construct scripts which consume excessive amounts of CPU time or RAM at each network node during script validation.<br>&#x5982;&#x679C;&#x4E0D;&#x5BF9;&#x9501;&#x5B9A;&#x548C;&#x89E3;&#x9501;&#x811A;&#x672C;&#x8FDB;&#x884C;&#x9650;&#x5B9A;&#xFF0C;&#x4E00;&#x4E2A;&#x6076;&#x610F;&#x7ED3;&#x70B9;&#x53EF;&#x4EE5;&#x6784;&#x9020;&#x51FA;&#x5728;&#x811A;&#x672C;&#x9A8C;&#x8BC1;&#x671F;&#x95F4;&#x6D88;&#x8D39;&#x6BCF;&#x4E2A;&#x7F51;&#x7EDC;&#x7ED3;&#x70B9;&#x8FC7;&#x91CF;CPU&#x65F6;&#x95F4;&#x548C;&#x5185;&#x5B58;&#x7684;&#x811A;&#x672C;&#x3002;<br>This constitutes a denial-of-service (DoS) attack on the network as regular transactions broadcasted by non-malicious nodes will experience delays before they are recorded on the blockchain.<br>&#x8FD9;&#x4F1A;&#x5728;&#x7F51;&#x7EDC;&#x4E0A;&#x5F62;&#x6210;&#x4E00;&#x6B21;&#x62D2;&#x7EDD;&#x670D;&#x52A1;&#x653B;&#x51FB;&#xFF08;denial-of-service, DoS&#xFF09;&#xFF0C;&#x5BFC;&#x81F4;&#x5F53;&#x5E38;&#x89C4;&#x4EA4;&#x6613;&#x88AB;&#x975E;&#x6076;&#x610F;&#x7ED3;&#x70B9;&#x5E7F;&#x64AD;&#x800C;&#x8BB0;&#x5F55;&#x8FDB;&#x533A;&#x5757;&#x94FE;&#x4E4B;&#x524D;&#x7684;&#x65F6;&#x5019;&#x4F1A;&#x906D;&#x9047;&#x65F6;&#x5EF6;&#x3002;<br>To avoid such DoS attacks, network nodes will not relay transactions containing scripts which do not belong a limited set of <em>standard scripts</em>.<br>Prior to SegWit activation, the set of standard challenge scripts consisted of the five script templates: Pay to Public Key(P2PK), Pay to Public Key Hash(P2PKH), m-of-n Multi-signature<br>&#x5728;&#x542F;&#x7528;SegWit&#x4E4B;&#x524D;&#xFF0C;&#x6807;&#x51C6;&#x6311;&#x6218;&#x811A;&#x672C;&#x96C6;&#x5408;&#x5305;&#x542B;&#x6709;5&#x4E2A;&#x811A;&#x672C;&#x6A21;&#x677F;&#xFF1A;&#x5411;&#x516C;&#x94A5;&#x4ED8;&#x6B3E;&#xFF08;P2PK&#xFF09;&#xFF0C;&#x5411;&#x516C;&#x94A5;&#x54C8;&#x5E0C;&#x4ED8;&#x6B3E;&#xFF08;P2PKH&#xFF09;&#xFF0C;&#x548C;m-of-n&#x591A;&#x91CD;&#x7B7E;&#x540D;&#x3002;</p>
<h3 id="Pay-To-Public-Key-P2PK"><a href="#Pay-To-Public-Key-P2PK" class="headerlink" title="Pay To Public Key(P2PK)"></a>Pay To Public Key(P2PK)</h3><p>The P2PK challenge script template has a <code>scriptPubkey</code> field which consists of a data push of a public key followed by the <code>OP_CHECKSIG</code> operator.<br>P2PK &#x9501;&#x5B9A;&#x811A;&#x672C;&#x6A21;&#x677F;&#x6709;&#x4E00;&#x4E2A; <code>scriptPubkey</code> &#x5B57;&#x6BB5;&#xFF0C;&#x8BE5;&#x5B57;&#x6BB5;&#x5305;&#x62EC;&#x4E00;&#x4E2A;&#x516C;&#x94A5;&#x6570;&#x636E;&#x7684;&#x5165;&#x6808;&#xFF0C;&#x540E;&#x9762;&#x7D27;&#x8DDF;&#x7740; <code>OP_CHECKSIG</code> &#x64CD;&#x4F5C;&#x7B26;&#x3002;<br>The public key can be in either compressed (33 bytes) or uncompressed (65 bytes) format.<br>&#x516C;&#x94A5;&#x53EF;&#x4EE5;&#x4EE5;&#x538B;&#x7F29;&#x5F62;&#x5F0F;&#xFF08;33 &#x5B57;&#x8282;&#xFF09;&#x6216;&#x975E;&#x538B;&#x7F29;&#x5F62;&#x5F0F;&#x5B58;&#x50A8;&#xFF08;65 &#x5B57;&#x8282;&#xFF09;&#x3002;<br>For compressed public keys, the <code>scriptPubkey</code> is of the form<br>&#x5BF9;&#x4E8E;&#x538B;&#x7F29;&#x7684;&#x516C;&#x94A5;&#xFF0C;<code>scriptPubkey</code> &#x6709;&#x5982;&#x4E0B;&#x5F62;&#x5F0F;</p>
<figure class="highlight plain hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">0x21 &lt;Compressed Public Key&gt; OP_CHECKSIG</span><br></pre></td></tr></table></figure>

<p>&#x5176;&#x4E2D;&#xFF0C;<code>0x21</code> &#x64CD;&#x4F5C;&#x7B26;&#x5F80;&#x6808;&#x4E2D;&#x538B;&#x5165;&#x5305;&#x542B;&#x4E4B;&#x540E;33&#x5B57;&#x8282;&#x7684;&#x5B57;&#x8282;&#x6570;&#x7EC4;&#x3002;&#x5BF9;&#x4E8E;&#x975E;&#x538B;&#x7F29;&#x5F62;&#x5F0F;&#x7684;&#x516C;&#x94A5;&#xFF0C;<code>scriptPubkey</code> &#x6709;&#x5982;&#x4E0B;&#x5F62;&#x5F0F;</p>
<figure class="highlight plain hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">0x41 &lt;Uncompressed Public Key&gt; OP_CHECKSIG</span><br></pre></td></tr></table></figure>

<p>&#x5176;&#x4E2D;&#xFF0C;&#x64CD;&#x4F5C;&#x7B26;<code>0x41</code>&#x5C06;&#x5176;&#x540E;65&#x4E2A;&#x5B57;&#x8282;&#x4F5C;&#x4E3A;&#x4E00;&#x4E2A;&#x5B57;&#x8282;&#x6570;&#x7EC4;&#x538B;&#x5165;&#x6808;&#x4E2D;&#x3002;<br>Usually, the sizes of data push operations are omitted from script descriptions.<br>With such an omission, the P2PK challenge script template is given by </p>
<figure class="highlight plain hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;Public Key&gt; OP_CHECKSIG</span><br></pre></td></tr></table></figure>

<p>Let $x_1$ and $x_2$ be the top two elements in the stack when the <code>OP_CHECKSIG</code> operator is executed.<br><code>OP_CHECKSIG</code> uses the ECDSA signature verification procedure from Section 2.5 to check that $x_2$ is a valid signature when $x_1$ is used as the public key.<br><img src="execute_op_checksig.png" alt="execute_op_checksig.png"></p>
<h3 id="m-of-n-Multi-Signature-Multisig"><a href="#m-of-n-Multi-Signature-Multisig" class="headerlink" title="m-of-n Multi-Signature (Multisig)"></a>m-of-n Multi-Signature (Multisig)</h3><p>A m-of-n multisig challenge script specifies n public keys and requires a valid response script to provide m ECDSA signatures created using any m out of the n private keys corresponding to these public keys.<br>&#x4E00;&#x4E2A; m-of-n &#x591A;&#x7B7E;&#x540D;&#x9501;&#x5B9A;&#x811A;&#x672C;&#x6307;&#x5B9A;&#x4E86; n &#x4E2A;&#x516C;&#x94A5;&#x5E76;&#x4E14;&#x8981;&#x6C42;&#x4E00;&#x4E2A;&#x6709;&#x6548;&#x7684;&#x89E3;&#x9501;&#x811A;&#x672C;&#x80FD;&#x63D0;&#x4F9B; m &#x4E2A; ECDSA &#x7B7E;&#x540D;&#x4F7F;&#x7528;&#x4ECE; n &#x4E2A;&#x79C1;&#x94A5;&#x4E2D;&#x6839;&#x636E;&#x516C;&#x94A5;&#x4EFB;&#x53D6; m &#x4E2A;&#x3002;</p>
<h3 id="Transaction-Version"><a href="#Transaction-Version" class="headerlink" title="Transaction Version"></a>Transaction Version</h3><h3 id="Input-Format"><a href="#Input-Format" class="headerlink" title="Input Format"></a>Input Format</h3><p>Each input in a pre-SegWit regular transaction has the same five fields.<br>Firgure 5.2 shows these fields for the first input.<br>The fields in the other inputs are not shown for brevity.<br>&#x4E3A;&#x4E86;&#x7B80;&#x6D01;&#x8868;&#x793A;&#xFF0C;&#x5176;&#x4ED6;&#x8F93;&#x5165;&#x6BB5;&#x7684;&#x5B57;&#x6BB5;&#x6CA1;&#x6709;&#x663E;&#x793A;&#x51FA;&#x6765;&#x3002;<br>The input fields have the following semantics.<br>&#x8F93;&#x5165;&#x5B57;&#x6BB5;&#x6709;&#x5982;&#x4E0B;&#x8BED;&#x4E49;&#x3002;</p>
<ul>
<li>The <code>hash</code> field contains the 256-bit transaction identifier(TXID) of a previous transaction containing the output which will be unlocked by this input. 256&#x6BD4;&#x7279;&#x4EA4;&#x6613;&#x6807;&#x8BC6;&#xFF08;TXID&#xFF09;&#x7684;<code>hash</code>&#x5B57;&#x6BB5;&#x5305;&#x542B;&#x5C06;&#x88AB;&#x6B64;&#x6B21;&#x8F93;&#x5165;&#x89E3;&#x9501;&#x7684;&#x524D;&#x4E00;&#x7B14;&#x4EA4;&#x6613;&#x7684;&#x8F93;&#x51FA;&#x3002; The field is called <code>hash</code> because the TXID is the double SHA-256 hash of the previous transaction. &#x79F0;&#x6B64;&#x5B57;&#x6BB5;&#x4E3A;<code>hash</code>&#x662F;&#x56E0;&#x4E3A;&#x6B64; TXID &#x662F;&#x524D;&#x4E00;&#x7B14;&#x4EA4;&#x6613;&#x7684;&#x53CC;SHA-256&#x6742;&#x51D1;&#x503C;&#x3002;</li>
<li>The 4-byte n field contains the index of the output being unlocked in the previous transaction.</li>
</ul>
<h1 id="Contracts"><a href="#Contracts" class="headerlink" title="Contracts"></a>Contracts</h1><p>In spite of its limited functionality, the Bitcoin scripting language can be used to create contracts which encode conditional exchange of bitcoins among entities.<br>&#x9664;&#x4E86;&#x9650;&#x5B9A;&#x597D;&#x7684;&#x529F;&#x80FD;&#x5916;&#xFF0C;&#x6BD4;&#x7279;&#x5E01;&#x811A;&#x672C;&#x8BED;&#x8A00;&#x53EF;&#x4EE5;&#x7528;&#x6765;&#x521B;&#x5EFA;&#x5728;&#x4E00;&#x4E9B;&#x6761;&#x4EF6;&#x4E0B;&#x7684;&#x5B9E;&#x4F53;&#x4E4B;&#x95F4;&#x4EA4;&#x6613;&#x6BD4;&#x7279;&#x5E01;&#x7684;&#x5408;&#x7EA6;&#x7F16;&#x7801;&#x3002;<br>The entities participating in a contract typically signal their intent by signing a transaction or by providing a valid response script to unlock a UTXO.<br>&#x53C2;&#x4E0E;&#x5408;&#x7EA6;&#x7684;&#x5B9E;&#x4F53;&#x901A;&#x5E38;&#x901A;&#x8FC7;&#x7ED9;&#x4EA4;&#x6613;&#x7B7E;&#x540D;&#x6216;&#x8005;&#x63D0;&#x4F9B;&#x4E00;&#x4E2A;UTXO&#x7684;&#x6709;&#x6548;&#x89E3;&#x9501;&#x811A;&#x672C;&#x6765;&#x5B8C;&#x6210;&#x8F6C;&#x8D26;&#x76EE;&#x7684;&#x3002;<br>Some contracts have safeguards protecting honest entities against malicious or uncooperative behaviour other participants.<br>&#x4E00;&#x4E9B;&#x5408;&#x7EA6;&#x5177;&#x6709;&#x4FDD;&#x62A4;&#x8BDA;&#x5B9E;&#x5B9E;&#x4F53;&#x62B5;&#x5FA1;&#x5176;&#x4ED6;&#x6210;&#x5458;&#x6076;&#x610F;&#x6216;&#x4E0D;&#x5408;&#x4F5C;&#x884C;&#x4E3A;&#x7684;&#x5B89;&#x5168;&#x4FDD;&#x969C;&#x3002;<br>These safaguards either enable complete recovery of the bitcoins invested by the honest entities while entering the contract.<br>&#x5F53;&#x8FDB;&#x5165;&#x5408;&#x7EA6;&#x65F6;&#xFF0C;&#x8FD9;&#x4E9B;&#x5B89;&#x5168;&#x4FDD;&#x969C;&#x4E5F;&#x80FD;&#x591F;&#x5B8C;&#x5168;&#x6062;&#x590D;&#x7531;&#x8BDA;&#x5B9E;&#x5B9E;&#x4F53;&#x6295;&#x8D44;&#x7684;&#x6BD4;&#x7279;&#x5E01;&#x3002;<br>While there are several contracts possible, we discuss three examples:<br>&#x6211;&#x4EEC;&#x4ECE;&#x82E5;&#x5E72;&#x4E2A;&#x5408;&#x7EA6;&#x9009;&#x51FA;&#x4E09;&#x4E2A;&#x4F8B;&#x5B50;&#x6765;&#x8BF4;&#x660E;&#xFF1A;escrow, &#x5FAE;&#x652F;&#x4ED8;, &#x548C;&#x53BB;&#x4E2D;&#x5FC3;&#x5316;</p>
<h2 id="Escrow"><a href="#Escrow" class="headerlink" title="Escrow"></a>Escrow</h2><p>Consider the scenario where Alice(the buyer) wants to purchase a used book from Bob(the seller) using bitcoins.<br>&#x5047;&#x8BBE;Alice&#xFF08;&#x4E70;&#x5BB6;&#xFF09;&#x60F3;&#x4F7F;&#x7528;&#x6BD4;&#x7279;&#x5E01;&#x4ECE; Bob&#xFF08;&#x5356;&#x5BB6;&#xFF09;&#x90A3;&#x91CC;&#x4E70;&#x4E00;&#x672C;&#x65E7;&#x4E66;&#x3002;<br>Alice and Bob live in different cities making it infeasible for them to meet and perform the transaction.<br>Alice &#x548C; Bob &#x4F4F;&#x5728;&#x4E0D;&#x540C;&#x7684;&#x57CE;&#x5E02;&#xFF0C;&#x8FD9;&#x4F7F;&#x5F97;&#x4ED6;&#x4EEC;&#x89C1;&#x9762;&#x6267;&#x884C;&#x4EA4;&#x6613;&#x53D8;&#x5F97;&#x4E0D;&#x53EF;&#x884C;&#x3002;<br>Bob promises to ship the book to Alice once he receives the bitcoin payment.<br>Bob &#x627F;&#x8BFA;&#x4E00;&#x65E6;&#x4ED6;&#x6536;&#x5230;&#x6BD4;&#x7279;&#x5E01;&#x4ED8;&#x6B3E;&#x4FBF;&#x628A;&#x4E66;&#x4EA4;&#x4ED8;&#x7ED9; Alice&#x3002;<br>But Alice does not trust Bob and fears that he may not send her the book after receiving the payment.<br>&#x4F46;&#x662F;Alice&#x4E0D;&#x4FE1;&#x4EFB;Bob&#x5E76;&#x4E14;&#x5BB3;&#x6015;&#x4ED6;&#x5728;&#x6536;&#x5230;&#x4ED8;&#x6B3E;&#x540E;&#x4E0D;&#x4F1A;&#x628A;&#x4E66;&#x7ED9;&#x5979;&#x3002;<br>To reduce her risk, Alice proposes to use an escrow contract to pay Bob.<br>&#x4E3A;&#x4E86;&#x964D;&#x4F4E;&#x98CE;&#x9669;&#xFF0C;Alice&#x5EFA;&#x8BAE;&#x4F7F;&#x7528;escrow&#x5408;&#x7EA6;&#x4EA4;&#x4ED8;&#x7ED9;Bob&#x3002;<br>The contract needs a third party Carol(the escrow) who both Alice and Bob trust.<br>&#x5408;&#x7EA6;&#x9700;&#x8981;&#x4E00;&#x4E2A;Alice&#x548C;Bob&#x90FD;&#x4FE1;&#x4EFB;&#x7684;&#x7B2C;&#x4E09;&#x65B9;Carol&#xFF08;escrow&#xFF09;&#x3002;<br>The contract proceeds as follows:<br>&#x5408;&#x7EA6;&#x6267;&#x884C;&#x5982;&#x4E0B;&#xFF1A;</p>
<ol>
<li>Alice requests public keys from Bob and Carol. Let these keys be <code>PubKeyB</code> and <code>PubKeyC</code> respectively.<br>Alice&#x5411;Bob&#x548C;Carol&#x7D22;&#x53D6;&#x516C;&#x94A5;&#xFF0C;&#x5206;&#x522B;&#x7528;<code>PubKeyB</code> &#x548C; <code>PubKeyC</code>&#x8868;&#x793A;&#x3002;</li>
<li>Alice transfers $x$ bitcoins to a 2-to-3 multisig output which has the challenge script<br>Alice &#x8F6C;$x$&#x6BD4;&#x7279;&#x5E01;&#x7ED9;&#x4E00;&#x4E2A;2-to-3 &#x591A;&#x7B7E;&#x540D;&#x8F93;&#x51FA;&#xFF0C;&#x591A;&#x7B7E;&#x540D;&#x8F93;&#x51FA;&#x5E26;&#x6709;&#x9501;&#x5B9A;&#x811A;&#x672C;&#xFF1A;<figure class="highlight plain hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">OP_2 &lt;PubKeyA&gt; &lt;PubKeyB&gt; &lt;PubKeyC&gt; OP_3 OP_CHECKMULTISIG</span><br></pre></td></tr></table></figure>

</li>
</ol>
<p>&#x5176;&#x4E2D; <code>PubKeyA</code> &#x662F; Alice &#x7684;&#x516C;&#x94A5;&#x3002;</p>
<ol start="3">
<li>Once Bob sees that Alice&#x2019;s transaction has appeared on the blockchain, he ships the book to Alice.<br>&#x4E00;&#x65E6;Bob&#x770B;&#x5230;Alice&#x7684;&#x4EA4;&#x6613;&#x51FA;&#x73B0;&#x5728;&#x533A;&#x5757;&#x94FE;&#x4E0A;&#xFF0C;&#x4ED6;&#x4FBF;&#x5BC4;&#x4E66;&#x7ED9;Alice&#x3002;</li>
<li>The funds locked in the multisig output can be spent if any two of Alice, Bob, and Carol provide signatures created by their respective private keys.<br>&#x5728;&#x591A;&#x7B7E;&#x540D;&#x8F93;&#x51FA;&#x4E2D;&#x9501;&#x5B9A;&#x7684;&#x57FA;&#x91D1;&#x53EF;&#x4EE5;&#x88AB;Alice&#xFF0C;Bob&#x548C;Carol&#x4E09;&#x4E2A;&#x4EBA;&#x4E4B;&#x4E2D;&#x7684;&#x4EFB;&#x610F;&#x4E24;&#x4E2A;&#x63D0;&#x4F9B;&#x7684;&#x79C1;&#x94A5;&#x3002;<br>Any of the three following scenarios can happen.<br>&#x4E0B;&#x9762;&#x7684;&#x573A;&#x666F;&#x90FD;&#x6709;&#x53EF;&#x80FD;&#x53D1;&#x751F;&#x3002;<br>(i) Alice is happy with the book she has received.<br>Alice&#x5F88;&#x6EE1;&#x610F;&#x5979;&#x6536;&#x5230;&#x7684;&#x4E66;&#x3002;<br>She signs a transaction which unlocks the 2-of-3 multisig output and transfers the $x$ bitcoins(minus the transaction fees) to the P2PK address containing Bob&#x2019;s public key.<br>&#x5979;&#x7B7E;&#x540D;&#x4EA4;&#x6613;&#x4EE5;&#x89E3;&#x9501;2-to-3&#x591A;&#x7B7E;&#x540D;&#x8F93;&#x51FA;&#xFF08;&#x6B64;&#x65F6;&#x53EA;&#x6709;1&#x4E2A;&#x7B7E;&#x540D;&#x5C1A;&#x4E0D;&#x80FD;&#x89E3;&#x9501;&#xFF09;&#xFF0C;&#x7136;&#x540E;&#x8F6C;&#x8D26; $x$ &#x6BD4;&#x7279;&#x5E01;&#xFF08;&#x51CF;&#x53BB;&#x4EA4;&#x6613;&#x7A0E;&#xFF09;&#x5230;Bob&#x7684;&#x516C;&#x94A5;&#x4ED8;&#x6B3E;&#x5730;&#x5740;&#x3002;<br>She sends this transaction to Bob who adds his own signature and broadcasts it on the network for inclusion on the blockchain.<br>&#x5979;&#x5C06;&#x8FD9;&#x7B14;&#x4EA4;&#x6613;&#x53D1;&#x7ED9;Bob&#xFF0C;Bob&#x5BF9;&#x8FD9;&#x7B14;&#x4EA4;&#x6613;&#x7B7E;&#x540D;&#xFF08;2&#x4E2A;&#x7B7E;&#x540D;&#x53EF;&#x4EE5;&#x5B8C;&#x6210;&#x89E3;&#x9501;&#x4E86;&#xFF09;&#x5E76;&#x4E14;&#x5E7F;&#x64AD;&#x5230;&#x7F51;&#x7EDC;&#x4EE5;&#x88AB;&#x6536;&#x7EB3;&#x8FDB;&#x533A;&#x5757;&#x94FE;&#x3002;<br>(ii) Alice receives the book but refuses to sign the transaction paying Bob.<br>Alice&#x6536;&#x5230;&#x4E86;&#x4E66;&#x4F46;&#x662F;&#x62D2;&#x7EDD;&#x7B7E;&#x540D;&#x4ED8;&#x6B3E;&#x7ED9;Bob&#x3002;<br>Bob provides proof of shipment to the escrow Carol and requests her to sign a transaction paying him.<br>Bob&#x63D0;&#x4F9B;&#x90AE;&#x5BC4;&#x8BC1;&#x636E;&#x7ED9;&#x53EF;&#x4FE1;&#x7B2C;&#x4E09;&#x65B9;Carol<br>(iii) Bob does not ship the book to Alice. Furthermore, he refuses to sign the transaction refunding the bitcoin to Alice.<br>Bob &#x6CA1;&#x6709;&#x5BC4;&#x4E66;&#x7ED9; Alice&#x3002;&#x8FDB;&#x4E00;&#x6B65;&#x5730;&#xFF0C;&#x4ED6;&#x6CA1;&#x6709;&#x7B7E;&#x7F72;&#x9000;&#x6B3E;&#x7ED9; Alice &#x7684;&#x4EA4;&#x6613;&#x3002;</li>
</ol>
<p>The above escrow contract fails if the escrow Carol colludes with Alice or Bob.<br>&#x5982;&#x679C;&#x7B2C;&#x4E09;&#x65B9;Carol&#x4E0E;Alice&#x6216;&#x8005;Bob&#x52FE;&#x7ED3;&#xFF0C;&#x5219;&#x4EE5;&#x4E0A;&#x7684;&#x53EF;&#x4FE1;&#x7B2C;&#x4E09;&#x65B9;&#x5408;&#x7EA6;&#x5C06;&#x5931;&#x6548;&#x3002;<br>If Alice and Carol collude, then they can refuse to pay Bob even if he sent the book to Alice.<br>If Bob and Carol collude, then they can transfer the bitcoins to any address without sending the book to Alice.<br>Another weakness of the contrast is that it is difficult for Bob to give proof of shipment.<br>He can send the tracking information of the package to Carol but the package ifself may be empty.<br>&#x4ED6;&#x53EF;&#x4EE5;&#x53D1;&#x9001;&#x5305;&#x88F9;&#x7269;&#x6D41;&#x4FE1;&#x606F;&#x7ED9;Carol&#x4F46;&#x662F;&#x5305;&#x88F9;&#x672C;&#x8EAB;&#x53EF;&#x80FD;&#x662F;&#x7A7A;&#x5305;&#x88F9;&#x3002;</p>
<h2 id="6-2-Micropayments"><a href="#6-2-Micropayments" class="headerlink" title="6.2 Micropayments"></a>6.2 Micropayments</h2><p>Even Bitcoin transaction involves paying transaction fees which makes using Bitcoin to make small payments expensive (the transaction fees may exceed the payment amount).<br>&#x5C3D;&#x7BA1;&#x6BD4;&#x7279;&#x5E01;&#x4EA4;&#x6613;&#x5305;&#x542B;&#x652F;&#x4ED8;&#x4EA4;&#x6613;&#x7A0E;&#xFF0C;&#x8FD9;&#x4F7F;&#x5F97;&#x4F7F;&#x7528;&#x6BD4;&#x7279;&#x5E01;&#x8FDB;&#x884C;&#x5C0F;&#x989D;&#x4ED8;&#x6B3E;&#x53D8;&#x5F97;&#x5F88;&#x6602;&#x8D35;&#xFF08;&#x4EA4;&#x6613;&#x7A0E;&#x53EF;&#x80FD;&#x8D85;&#x8FC7;&#x4ED8;&#x6B3E;&#x503C;&#xFF09;&#xFF0C;<br>But if a sequence of small payments are to be made to the same entity, the micropayment contract can be used which aggregates the small payments and requires that transaction fees be paid for only one transation.<br>&#x4F46;&#x662F;&#x5982;&#x679C;&#x4E00;&#x7CFB;&#x5217;&#x7684;&#x5C0F;&#x989D;&#x4ED8;&#x6B3E;&#x7ED9;&#x540C;&#x4E00;&#x5B9E;&#x4F53;&#xFF0C;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;&#x5FAE;&#x4ED8;&#x6B3E;&#x5408;&#x7EA6;&#x6765;&#x6C47;&#x96C6;&#x5C0F;&#x989D;&#x4ED8;&#x6B3E;&#x548C;&#x8981;&#x6C42;&#x4EA4;&#x6613;&#x7A0E;&#x53EA;&#x4ED8;&#x7ED9;&#x4E00;&#x4E2A;&#x4EA4;&#x6613;&#x3002;<br>Consider the scenario where Alice offers proofreading and editing services online in return for bitcoins.<br>&#x8003;&#x8651;&#x4EE5;&#x4E0B;&#x5E94;&#x7528;&#x573A;&#x666F;&#xFF0C;Alice&#x63D0;&#x4F9B;&#x5728;&#x7EBF;&#x6821;&#x5BF9;&#x548C;&#x7F16;&#x8F91;&#x670D;&#x52A1;&#x4EE5;&#x6362;&#x53D6;&#x6BD4;&#x7279;&#x5E01;&#x3002;<br>Clients can email Alice their documents and Alice will reply with typos and grammatical errors she has found in the documents.<br>&#x5BA2;&#x6237;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x90AE;&#x4EF6;&#x7ED9;Alice&#x53D1;&#x9001;&#x4ED6;&#x4EEC;&#x7684;&#x6587;&#x6863;&#x7136;&#x540E;Alice&#x5C06;&#x8FD4;&#x56DE;&#x5979;&#x5728;&#x6587;&#x6863;&#x4E2D;&#x627E;&#x5230;&#x7684;&#x6253;&#x5370;&#x548C;&#x8BED;&#x6CD5;&#x9519;&#x8BEF;&#x3002;</p>

    
    </div>
    
    <div class="columns is-variable is-1 is-multiline is-mobile">
    
        <span class="column is-narrow"><a class="tag is-light article-tag" href="/zh-cn/tags/Academic/">#Academic</a></span>
    
        <span class="column is-narrow"><a class="tag is-light article-tag" href="/zh-cn/tags/Blockchain/">#Blockchain</a></span>
    
    </div>
    
    
    <div class="columns is-mobile is-multiline article-nav">
        <span class="column is-12-mobile is-half-desktop  article-nav-prev">
            
            <a href="/zh-cn/Nov-27th-Spring-Cloud-microservices-management-Nacos/">Spring Cloud 微服务注册与发现实验</a>
            
        </span>
        <span class="column is-12-mobile is-half-desktop  article-nav-next">
            
            <a href="/zh-cn/Security-as-a-Service-for-Microservices-Based-Cloud-Applications/">Security-as-a-Service for Microservices-Based Cloud Applications</a>
            
        </span>
    </div>
    
</article>


<div class="sharebox">
    
<div class="notification is-danger">
    You need to set <code>install_url</code> to use ShareThis. Please set it in <code>_config.yml</code>.
</div>

</div>



<div class="comments">
    <h3 class="title is-4">评论</h3>
    
<div id="disqus_thread">
    
    <div class="notification is-danger">
        You forgot to set the <code>shortname</code> for Disqus. Please set it in <code>_config.yml</code>.
    </div>
    
    <noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
</div>

    </div>
</section>
    <footer class="footer">
    <div class="container">
        <div class="columns content">
            <div class="column is-narrow has-text-centered">
                &copy; 2022 Shane Wang&nbsp;
                Powered by <a href="http://hexo.io/" target="_blank">Hexo</a> & <a href="http://github.com/ppoffice/hexo-theme-minos">Minos</a>
            </div>
            <div class="column is-hidden-mobile"></div>

            
            <div class="column is-narrow">
                <div class="columns is-mobile is-multiline is-centered">
                
                    
                <a class="column is-narrow has-text-black" title="GitHub" href="https://github.com/ppoffice/hexo-theme-minos">
                    
                    GitHub
                    
                </a>
                
                </div>
            </div>
            
        </div>
    </div>
</footer>

    <script src="//cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/moment.js/2.22.2/moment-with-locales.min.js"></script>

<!-- test if the browser is outdated -->
<div id="outdated">
    <h6>Your browser is out-of-date!</h6>
    <p>Update your browser to view this website correctly. <a id="btnUpdateBrowser" href="http://outdatedbrowser.com/">Update my browser now </a></p>
    <p class="last"><a href="#" id="btnCloseUpdateBrowser" title="Close">&times;</a></p>
</div>
<script src="//cdnjs.cloudflare.com/ajax/libs/outdated-browser/1.1.5/outdatedbrowser.min.js"></script>
<script>
    $(document).ready(function () {
        // plugin function, place inside DOM ready function
        outdatedBrowser({
            bgColor: '#f25648',
            color: '#ffffff',
            lowerThan: 'flex'
        })
    });
</script>

<script>
    window.FontAwesomeConfig = {
        searchPseudoElements: true
    }
    moment.locale("zh-CN");
</script>


    
    
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/MathJax.js?config=TeX-MML-AM_CHTML"></script>
<script>
    MathJax.Hub.Config({
        "HTML-CSS": {
            matchFontHeight: false
        },
        SVG: {
            matchFontHeight: false
        },
        CommonHTML: {
            matchFontHeight: false
        },
        tex2jax: {
            inlineMath: [
                ['$','$'],
                ['\\(','\\)']
            ]
        }
    });
</script>

    
    
    
    
<script src="//cdnjs.cloudflare.com/ajax/libs/lightgallery/1.6.8/js/lightgallery-all.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/justifiedGallery/3.6.5/js/jquery.justifiedGallery.min.js"></script>
<script>
    (function ($) {
        $(document).ready(function () {
            if (typeof($.fn.lightGallery) === 'function') {
                $('.article.gallery').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof($.fn.justifiedGallery) === 'function') {
                $('.justified-gallery').justifiedGallery();
            }
        });
    })(jQuery);
</script>

    
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.0/clipboard.min.js"></script>
    <style>
        .hljs {
            position: relative;
        }

        .hljs .clipboard-btn {
            float: right;
            color: #9a9a9a;
            background: none;
            border: none;
            cursor: pointer;
        }

        .hljs .clipboard-btn:hover {
          color: #8a8a8a;
        }

        .hljs > .clipboard-btn {
            display: none;
            position: absolute;
            right: 4px;
            top: 4px;
        }

        .hljs:hover > .clipboard-btn {
            display: inline;
        }

        .hljs > figcaption > .clipboard-btn {
            margin-right: 4px;
        }
    </style>
    <script>
      $(document).ready(function () {
        $('figure.hljs').each(function(i, figure) {
          var codeId = 'code-' + i;
          var code = figure.querySelector('.code');
          var copyButton = $('<button>Copy <i class="far fa-clipboard"></i></button>');
          code.id = codeId;
          copyButton.addClass('clipboard-btn');
          copyButton.attr('data-clipboard-target-id', codeId);

          var figcaption = figure.querySelector('figcaption');

          if (figcaption) {
            figcaption.append(copyButton[0]);
          } else {
            figure.prepend(copyButton[0]);
          }
        })

        var clipboard = new ClipboardJS('.clipboard-btn', {
          target: function(trigger) {
            return document.getElementById(trigger.getAttribute('data-clipboard-target-id'));
          }
        });
        clipboard.on('success', function(e) {
          e.clearSelection();
        })
      })
    </script>

    
    

    


<script src="/js/script.js"></script>

    
    <div class="searchbox ins-search">
    <div class="searchbox-mask"></div>
    <div class="searchbox-container ins-search-container">
        <div class="searchbox-input-wrapper">
            <input type="text" class="searchbox-input ins-search-input" placeholder="站内搜索">
            <span class="searchbox-close ins-close ins-selectable"><i class="fa fa-times-circle"></i></span>
        </div>
        <div class="searchbox-result-wrapper ins-section-wrapper">
            <div class="ins-section-container"></div>
        </div>
    </div>
</div>
<script>
    (function (window) {
        var INSIGHT_CONFIG = {
            TRANSLATION: {
                POSTS: '文章',
                PAGES: '页面',
                CATEGORIES: '分类',
                TAGS: '标签',
                UNTITLED: '(无标题)',
            },
            CONTENT_URL: '/content.zh-cn.json',
        };
        window.INSIGHT_CONFIG = INSIGHT_CONFIG;
    })(window);
</script>
<script src="/js/insight.js"></script><!-- hexo-inject:begin --><!-- Begin: Injected MathJax -->
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({"tex2jax":{"inlineMath":[["$","$"],["\\(","\\)"]],"skipTags":["script","noscript","style","textarea","pre","code"],"processEscapes":true},"TeX":{"equationNumbers":{"autoNumber":"AMS"}}});
</script>

<script type="text/x-mathjax-config">
  MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
      all[i].SourceElement().parentNode.className += ' has-jax';
    }
  });
</script>

<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js">
</script>
<!-- End: Injected MathJax -->
<!-- hexo-inject:end -->
    
</body>
</html>